<!doctype html>
<html lang="en">

<head>
  <title>OTA: Next Train Arrivals</title>
</head>

<style type="text/css">
  .htmx-swapping {
    opacity: 0;
    transition: opacity 1s ease-out;
  }

  .sr-only {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
  }

  body {
    box-sizing: border-box;
    background: #161616;
    color: #eee;
    display: flex;
    padding: 2ch;
    flex-direction: column;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  }

  header,
  main {
    font-size: 2rem;
    flex: 1;
    width: 100%;
    display: flex;
  }


  header {
    display: flex;

    & h1 {
      flex: 1;
    }

    & p {
      font-size: 1rem;
      opacity: 0.9;
    }
  }

  h1 {
    font-size: 2.5rem;
  }

  table.arrivals {
    flex: 1;
    line-height: 2.5rem;

    & .line {
      background-repeat: no-repeat;

      background-position: center;
      background-size: contain;
      width: 3ch;
    }

    & .line-A {
      background-image: url('/static/A.svg');
    }

    & .line-C {
      background-image: url('/static/C.svg');
    }

    & .line-F {
      background-image: url('/static/F.svg');
    }

    & .line-FX {
      background-image: url('/static/FX.svg');
    }

    & .line-R {
      background-image: url('/static/R.svg');
    }

    & .dest {
      font-weight: 600;
      padding: 1ch;
    }

    & .time {
      font-variant-numeric: tabular-nums;
      -moz-font-feature-settings: "tnum";
      -webkit-font-feature-settings: "tnum";
      font-feature-settings: "tnum";
      text-align: right;

      &.time-due {
        font-weight: bold;
        font-size: 80%;
      }
    }
  }
</style>
<script src="{{url_for('static', filename='htmx.min.js')}}"></script>

<body hx-get="/" hx-trigger="every 3s" hx-swap="morph:innerHTML">
  <header>
    <div>

      <h1>
        Next Train Arrivals: Jay Stâ€”MetroTech</h1>
      <p>Last updated: {{last_updated}}</p>
    </div>
    <img alt="loading" class="htmx-indicator" src="{{url_for('static', filename='spinner.svg')}}">
  </header>
  <main>
    <table class="arrivals">
      <tbody>
        {% for arrival in arrivals %}
        <tr class="arrival">
          <td class="line line-{{arrival[0]}}"><span class="sr-only">{{arrival[0]}}</span></td>
          <td class="dest">{{arrival[1]}}</td>
          {% if arrival[3] < 1 %} <td class="time time-due">due</td> {% else %}
            <td class="time"><time datetime="{{arrival[2]}}">{{arrival[3]}} <small>min</small></time>
              {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </main>
</body>

</html>